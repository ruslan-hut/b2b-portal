<div class="admin-container">
  <!-- Mobile Header -->
  <header class="mobile-header">
    <button class="mobile-menu-btn" (click)="toggleMobileMenu()" aria-label="Toggle menu">
      <span class="material-icons">{{ isMobileMenuOpen ? 'close' : 'menu' }}</span>
    </button>
    <h1>Admin Zone</h1>
    <button class="mobile-close-btn" (click)="goToClientZone()" aria-label="Exit admin zone">
      <span class="material-icons">close</span>
    </button>
  </header>

  <!-- Mobile Dropdown Menu -->
  @if (isMobileMenuOpen) {
    <div class="mobile-menu-backdrop" (click)="closeMobileMenu()"></div>
    <nav class="mobile-dropdown-menu">
      <ul>
        <li>
          <a routerLink="/admin/dashboard" routerLinkActive="active" (click)="closeMobileMenu()">
            <span class="material-icons">dashboard</span>
            <span>Dashboard</span>
          </a>
        </li>
        <li>
          <a routerLink="/admin/crm" routerLinkActive="active" (click)="closeMobileMenu()">
              <span class="material-icons">view_kanban</span>
              <span>CRM Pipeline</span>
          </a>
        </li>
        <li>
          <a routerLink="/admin/chat" routerLinkActive="active" (click)="closeMobileMenu()">
            <span class="material-icons">chat_bubble</span>
            <span>Chat</span>
            @if ((totalUnread$ | async); as count) {
              <span class="mobile-unread-badge">{{ count > 99 ? '99+' : count }}</span>
            }
          </a>
        </li>
        <li>
          <a routerLink="/admin/clients" routerLinkActive="active" (click)="closeMobileMenu()">
            <span class="material-icons">people</span>
            <span>Clients</span>
          </a>
        </li>
        <li>
          <a routerLink="/admin/orders" routerLinkActive="active" (click)="closeMobileMenu()">
            <span class="material-icons">receipt</span>
            <span>Orders</span>
          </a>
        </li>
        <li>
          <a routerLink="/admin/products" routerLinkActive="active" (click)="closeMobileMenu()">
            <span class="material-icons">inventory_2</span>
            <span>Products</span>
          </a>
        </li>
        @if (isAdmin) {
          <li>
            <a routerLink="/admin/users" routerLinkActive="active" (click)="closeMobileMenu()">
              <span class="material-icons">person</span>
              <span>Users</span>
            </a>
          </li>
          <li>
            <a routerLink="/admin/tables" routerLinkActive="active" (click)="closeMobileMenu()">
              <span class="material-icons">table_chart</span>
              <span>Database Tables</span>
            </a>
          </li>
          <li>
            <a routerLink="/admin/logs" routerLinkActive="active" (click)="closeMobileMenu()">
              <span class="material-icons">description</span>
              <span>Logs</span>
            </a>
          </li>
          <li>
            <a routerLink="/admin/webhooks" routerLinkActive="active" (click)="closeMobileMenu()">
              <span class="material-icons">webhook</span>
              <span>Webhooks</span>
            </a>
          </li>
          <li>
            <a routerLink="/admin/telegram" routerLinkActive="active" (click)="closeMobileMenu()">
              <span class="material-icons">send</span>
              <span>Telegram</span>
            </a>
          </li>
          <li>
            <a routerLink="/admin/mail" routerLinkActive="active" (click)="closeMobileMenu()">
              <span class="material-icons">email</span>
              <span>Mail</span>
            </a>
          </li>
          <li>
            <a routerLink="/admin/invoice" routerLinkActive="active" (click)="closeMobileMenu()">
              <span class="material-icons">receipt_long</span>
              <span>Invoice</span>
            </a>
          </li>
          <li>
            <a routerLink="/admin/shipment" routerLinkActive="active" (click)="closeMobileMenu()">
              <span class="material-icons">local_shipping</span>
              <span>Shipment</span>
            </a>
          </li>
        }
      </ul>
    </nav>
  }

  <!-- Desktop Sidebar -->
  <nav class="admin-nav" [class.collapsed]="isMenuCollapsed">
    <div class="nav-header">
      <div class="header-top">
        @if (!isMenuCollapsed) {
          <h2>Admin Zone</h2>
        }
        <button class="toggle-btn" (click)="toggleMenu()" [attr.aria-label]="isMenuCollapsed ? 'Expand menu' : 'Collapse menu'">
          <span class="material-icons">{{ isMenuCollapsed ? 'chevron_right' : 'chevron_left' }}</span>
        </button>
      </div>
    </div>
    <ul class="nav-menu">
      <li>
        <a routerLink="/admin/dashboard" routerLinkActive="active" [title]="isMenuCollapsed ? 'Dashboard' : ''">
          <span class="material-icons">dashboard</span>
          @if (!isMenuCollapsed) {
            <span class="text">Dashboard</span>
          }
        </a>
      </li>
        <li>
            <a routerLink="/admin/crm" routerLinkActive="active" [title]="isMenuCollapsed ? 'CRM Pipeline' : ''">
                <span class="material-icons">view_kanban</span>
                @if (!isMenuCollapsed) {
                    <span class="text">CRM Pipeline</span>
                }
            </a>
        </li>
      <li>
        <a routerLink="/admin/chat" routerLinkActive="active" [title]="isMenuCollapsed ? 'Chat' : ''" class="chat-link">
          <span class="material-icons">chat_bubble</span>
          @if (!isMenuCollapsed) {
            <span class="text">Chat</span>
          }
          @if ((totalUnread$ | async); as count) {
            @if (isMenuCollapsed) {
              <span class="sidebar-unread-badge collapsed-badge"></span>
            } @else {
              <span class="sidebar-unread-badge">{{ count > 99 ? '99+' : count }}</span>
            }
          }
        </a>
      </li>
      <li>
        <a routerLink="/admin/clients" routerLinkActive="active" [title]="isMenuCollapsed ? 'Clients' : ''">
          <span class="material-icons">people</span>
          @if (!isMenuCollapsed) {
            <span class="text">Clients</span>
          }
        </a>
      </li>
      <li>
        <a routerLink="/admin/orders" routerLinkActive="active" [title]="isMenuCollapsed ? 'Orders' : ''">
          <span class="material-icons">receipt</span>
          @if (!isMenuCollapsed) {
            <span class="text">Orders</span>
          }
        </a>
      </li>
      <li>
        <a routerLink="/admin/products" routerLinkActive="active" [title]="isMenuCollapsed ? 'Products' : ''">
          <span class="material-icons">inventory_2</span>
          @if (!isMenuCollapsed) {
            <span class="text">Products</span>
          }
        </a>
      </li>
      @if (isAdmin) {
        <li>
          <a routerLink="/admin/users" routerLinkActive="active" [title]="isMenuCollapsed ? 'Users' : ''">
            <span class="material-icons">person</span>
            @if (!isMenuCollapsed) {
              <span class="text">Users</span>
            }
          </a>
        </li>
      }
      @if (isAdmin) {
        <li>
          <a routerLink="/admin/tables" routerLinkActive="active" [title]="isMenuCollapsed ? 'Database Tables' : ''">
            <span class="material-icons">table_chart</span>
            @if (!isMenuCollapsed) {
              <span class="text">Database Tables</span>
            }
          </a>
        </li>
      }
      @if (isAdmin) {
        <li>
          <a routerLink="/admin/logs" routerLinkActive="active" [title]="isMenuCollapsed ? 'Logs' : ''">
            <span class="material-icons">description</span>
            @if (!isMenuCollapsed) {
              <span class="text">Logs</span>
            }
          </a>
        </li>
      }
      @if (isAdmin) {
        <li>
          <a routerLink="/admin/webhooks" routerLinkActive="active" [title]="isMenuCollapsed ? 'Webhooks' : ''">
            <span class="material-icons">webhook</span>
            @if (!isMenuCollapsed) {
              <span class="text">Webhooks</span>
            }
          </a>
        </li>
      }
      @if (isAdmin) {
        <li>
          <a routerLink="/admin/telegram" routerLinkActive="active" [title]="isMenuCollapsed ? 'Telegram' : ''">
            <span class="material-icons">send</span>
            @if (!isMenuCollapsed) {
              <span class="text">Telegram</span>
            }
          </a>
        </li>
      }
      @if (isAdmin) {
        <li>
          <a routerLink="/admin/mail" routerLinkActive="active" [title]="isMenuCollapsed ? 'Mail' : ''">
            <span class="material-icons">email</span>
            @if (!isMenuCollapsed) {
              <span class="text">Mail</span>
            }
          </a>
        </li>
      }
      @if (isAdmin) {
        <li>
          <a routerLink="/admin/invoice" routerLinkActive="active" [title]="isMenuCollapsed ? 'Invoice' : ''">
            <span class="material-icons">receipt_long</span>
            @if (!isMenuCollapsed) {
              <span class="text">Invoice</span>
            }
          </a>
        </li>
      }
      @if (isAdmin) {
        <li>
          <a routerLink="/admin/shipment" routerLinkActive="active" [title]="isMenuCollapsed ? 'Shipment' : ''">
            <span class="material-icons">local_shipping</span>
            @if (!isMenuCollapsed) {
              <span class="text">Shipment</span>
            }
          </a>
        </li>
      }
    </ul>
    <div class="nav-footer">
      <button class="exit-btn" (click)="goToClientZone()" [title]="isMenuCollapsed ? 'Exit Admin' : ''">
        <span class="material-icons">logout</span>
        @if (!isMenuCollapsed) {
          <span class="text">Exit Admin</span>
        }
      </button>
    </div>
  </nav>
  <main class="admin-content" [class.expanded]="isMenuCollapsed">
    <router-outlet></router-outlet>
  </main>

</div>

