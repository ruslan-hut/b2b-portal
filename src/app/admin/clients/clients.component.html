<div class="clients-container">
  <div class="header">
    <h1>Clients Management</h1>
    <button class="btn-primary" (click)="createClient()">+ Add Client</button>
  </div>

  <div class="filters">
    <div class="filter-group">
      <label>Status:</label>
      <select [(ngModel)]="activeFilter" (change)="onFilterChange()">
        <option value="all">All</option>
        <option value="active">Active</option>
        <option value="inactive">Inactive</option>
      </select>
    </div>
    <div class="filter-group">
      <label>Search:</label>
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
        placeholder="Search by name, email, or phone"
      />
    </div>
  </div>

  <div *ngIf="loading" class="loading">Loading clients...</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <div *ngIf="!loading && !error" class="clients-table">
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Address</th>
          <th>Discount</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let client of filteredClients">
          <td>{{ client.name }}</td>
          <td>{{ client.email || '-' }}</td>
          <td>{{ client.phone }}</td>
          <td>{{ client.address || '-' }}</td>
          <td>{{ client.discount }}%</td>
          <td>
            <span [class.active]="client.active" [class.inactive]="!client.active">
              {{ client.active ? 'Active' : 'Inactive' }}
            </span>
          </td>
          <td class="actions">
            <button class="btn-edit" (click)="editClient(client)">Edit</button>
            <button class="btn-toggle" (click)="toggleActive(client)">
              {{ client.active ? 'Deactivate' : 'Activate' }}
            </button>
            <button class="btn-delete" (click)="deleteClient(client)">Delete</button>
          </td>
        </tr>
        <tr *ngIf="filteredClients.length === 0">
          <td colspan="7" class="no-data">No clients found</td>
        </tr>
      </tbody>
    </table>

    <div class="pagination" *ngIf="totalPages > 1">
      <button [disabled]="currentPage === 1" (click)="goToPage(currentPage - 1)">Previous</button>
      <span>Page {{ currentPage }} of {{ totalPages }} ({{ total }} total)</span>
      <button [disabled]="currentPage === totalPages" (click)="goToPage(currentPage + 1)">Next</button>
    </div>
  </div>

  <!-- Edit/Create Modal -->
  <div *ngIf="showEditModal" class="modal-overlay" (click)="cancelEdit()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h2>{{ editingClient ? 'Edit Client' : 'Create Client' }}</h2>
      <form (ngSubmit)="saveClient()">
        <div class="form-group">
          <label>Name *</label>
          <input type="text" [(ngModel)]="editForm.name" name="name" required />
        </div>
        <div class="form-group">
          <label>Email</label>
          <input type="email" [(ngModel)]="editForm.email" name="email" />
        </div>
        <div class="form-group">
          <label>Phone *</label>
          <input type="text" [(ngModel)]="editForm.phone" name="phone" required />
        </div>
        <div class="form-group">
          <label>PIN Code</label>
          <input type="text" [(ngModel)]="editForm.pin_code" name="pin_code" />
        </div>
        <div class="form-group">
          <label>Address</label>
          <textarea [(ngModel)]="editForm.address" name="address"></textarea>
        </div>
        <div class="form-group">
          <label>Discount (%)</label>
          <input type="number" [(ngModel)]="editForm.discount" name="discount" min="0" max="100" />
        </div>
        <div class="form-group">
          <label>Store UID *</label>
          <input type="text" [(ngModel)]="editForm.store_uid" name="store_uid" required />
        </div>
        <div class="form-group">
          <label>Price Type UID *</label>
          <input type="text" [(ngModel)]="editForm.price_type_uid" name="price_type_uid" required />
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" [(ngModel)]="editForm.active" name="active" />
            Active
          </label>
        </div>
        <div class="form-actions">
          <button type="button" class="btn-cancel" (click)="cancelEdit()">Cancel</button>
          <button type="submit" class="btn-save">Save</button>
        </div>
      </form>
    </div>
  </div>
</div>

